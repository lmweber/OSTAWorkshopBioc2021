<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2. Dataset and preprocessing • OSTAWorkshopBioc2021</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="2. Dataset and preprocessing">
<meta property="og:description" content="OSTAWorkshopBioc2021">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">OSTAWorkshopBioc2021</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Vignette01_Introduction.html">1. Introduction</a>
    </li>
    <li>
      <a href="../articles/Vignette02_Dataset_and_preprocessing.html">2. Dataset and preprocessing</a>
    </li>
    <li>
      <a href="../articles/Vignette03_Analysis_workflow.html">3. Analysis workflow</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/lmweber/OSTAWorkshopBioc2021">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Vignette02_Dataset_and_preprocessing_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>2. Dataset and preprocessing</h1>
                        <h4 class="author">Lukas M. Weber</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/lmweber/OSTAWorkshopBioc2021/blob/master/vignettes/Vignette02_Dataset_and_preprocessing.Rmd"><code>vignettes/Vignette02_Dataset_and_preprocessing.Rmd</code></a></small>
      <div class="hidden name"><code>Vignette02_Dataset_and_preprocessing.Rmd</code></div>

    </div>

    
    
<p>Last updated: 2021-08-07</p>
<div id="example-dataset-human-brain-dlpfc-region" class="section level2">
<h2 class="hasAnchor">
<a href="#example-dataset-human-brain-dlpfc-region" class="anchor"></a>Example dataset: human brain DLPFC region</h2>
<p>For the examples in this workshop, we use a human brain dataset from the <a href="https://www.10xgenomics.com/products/spatial-gene-expression">10x Genomics Visium</a> platform, which was previously described in our publication <a href="https://www.nature.com/articles/s41593-020-00787-0">Maynard and Collado-Torres et al. (2021)</a>.</p>
<p>The example dataset consists of a single sample from the human brain dorsolateral prefrontal cortex (DLPFC) region. This region contains six cortical layers and white matter, which can be distinguished by their molecular expression profiles, and have a layered spatial structure.</p>
<p>The full dataset contains 12 samples in total, from 3 individuals, with 2 pairs of “spatially adjacent” replicates (serial sections) per individual (4 samples per individual). The individuals and spatially adjacent replicates can be considered as blocking factors. Each sample spans the six layers of the cortex plus white matter in a perpendicular tissue section.</p>
<p>For the examples in this workshop, we use a single sample from this dataset (sample 151673).</p>
<p>For more details, see <a href="https://www.nature.com/articles/s41593-020-00787-0">Maynard and Collado-Torres et al. (2021)</a>. The full dataset is publicly available through the <a href="http://bioconductor.org/packages/spatialLIBD">spatialLIBD</a> Bioconductor package, and the analysis code from our paper is provided in the <a href="https://github.com/LieberInstitute/HumanPilot">HumanPilot</a> GitHub repository. The dataset can also be explored interactively through the <a href="http://spatial.libd.org/spatialLIBD/">spatialLIBD Shiny web app</a>.</p>
</div>
<div id="preprocessing-steps" class="section level2">
<h2 class="hasAnchor">
<a href="#preprocessing-steps" class="anchor"></a>Preprocessing steps</h2>
<p>After performing the Visium experiment, there are several steps needed to process the data and load it into R for downstream analysis.</p>
<p>These steps are described in detail in the <a href="https://lmweber.org/OSTA-book/preprocessing-steps.html">Preprocessing steps</a> part in OSTA. Here, we provide a short overview and links.</p>
</div>
<div id="image-segmentation-and-cell-counting" class="section level2">
<h2 class="hasAnchor">
<a href="#image-segmentation-and-cell-counting" class="anchor"></a>Image segmentation and cell counting</h2>
<p>The first step is to process the raw images, which includes splitting multiple capture areas into individual samples, segmenting cell nuclei, and identifying the number of cells per spot.</p>
<p>For more details, see the chapter <a href="https://lmweber.org/OSTA-book/image-segmentation-visium.html">Image segmentation (Visium)</a> in OSTA, as well as the paper <a href="https://www.biorxiv.org/content/10.1101/2021.08.04.452489v1">Tippani et al. (2021)</a> describing the <a href="https://github.com/LieberInstitute/VistoSeg">VistoSeg</a> tool.</p>
<p>Note that part of this step also requires the Space Ranger outputs described next.</p>
</div>
<div id="loupe-browser-and-space-ranger" class="section level2">
<h2 class="hasAnchor">
<a href="#loupe-browser-and-space-ranger" class="anchor"></a>Loupe Browser and Space Ranger</h2>
<p>The <a href="https://www.10xgenomics.com/products/loupe-browser">Loupe Browser</a> and <a href="https://support.10xgenomics.com/spatial-gene-expression/software/pipelines/latest/what-is-space-ranger">Space Ranger</a> software provided by 10x Genomics are used to align sequencing reads, match the sequencing data to the spatial coordinates on the image, as well as an initial inspection of data quality and exploration of the data.</p>
<p>For more details, see chapters <a href="https://lmweber.org/OSTA-book/loupe-browser-visium.html">Loupe Browser (Visium)</a> and <a href="https://lmweber.org/OSTA-book/space-ranger-visium.html">Space Ranger (Visium)</a> in OSTA.</p>
</div>
<div id="spatialexperiment" class="section level2">
<h2 class="hasAnchor">
<a href="#spatialexperiment" class="anchor"></a>SpatialExperiment</h2>
<p>After running Loupe Browser and Space Ranger, we are ready to load the data into R.</p>
<p>For this, we use the <a href="https://bioconductor.org/packages/SpatialExperiment">SpatialExperiment</a> data structure. For more details, see the <a href="https://lmweber.org/OSTA-book/spatialexperiment.html">SpatialExperiment</a> chapter in OSTA, or our additional <a href="https://drighelli.github.io/SpatialExperiment_Bioc2021/index.html">SpatialExperiment workshop</a>.</p>
<p>The schematic below illustrates the <code>SpatialExperiment</code> structure, which extends <a href="https://bioconductor.org/packages/SingleCellExperiment">SingleCellExperiment</a> to include additional spatial information. The structure is flexible, and has been designed to work with data from 10x Genomics Visium as well as other spot-based and molecule-based ST platforms.</p>
<div class="figure" style="text-align: center">
<img src="../inst/images/spe.png" alt="Schematic illustrating [SpatialExperiment](https://bioconductor.org/packages/SpatialExperiment) class structure." width="100%"><p class="caption">
Schematic illustrating <a href="https://bioconductor.org/packages/SpatialExperiment">SpatialExperiment</a> class structure.
</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Lukas M. Weber.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
